<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Frontend, Mobile, Nodejs, Life Essays, etc."><title>window.pageYOffset, window.pageXOffset, clientWidth, clientHeight, etc,一些JavaScript的基础属性及实战应用 | Poeticlife</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">window.pageYOffset, window.pageXOffset, clientWidth, clientHeight, etc,一些JavaScript的基础属性及实战应用</h1><a id="logo" href="/.">Poeticlife</a><p class="description">大知闲闲，小知间间；大言炎炎，小言詹詹</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/categories/Tech/"><i class="fa fa-wrench"> 技术</i></a><a href="/categories/Essays/"><i class="fa fa-pencil"> 随笔</i></a><a href="/categories/works/"><i class="fa fa-briefcase"> 作品</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">window.pageYOffset, window.pageXOffset, clientWidth, clientHeight, etc,一些JavaScript的基础属性及实战应用</h1><div class="post-meta">Oct 8, 2017<span> | </span><span class="category"><a href="/categories/Tech/">Tech</a><a href="/categories/Tech/FrontEnd/">FrontEnd</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>当你在编写某些插件的时候，你对于JavaScript的基础知识的掌握情况将会极大地影响到你写的东西。下面介绍这些基础属性及实战如下：</p>
<h2 id="window-pageYOffset-window-pageXOffset"><a href="#window-pageYOffset-window-pageXOffset" class="headerlink" title="window.pageYOffset, window.pageXOffset"></a>window.pageYOffset, window.pageXOffset</h2><p>  获得文档在垂直方向或者水平方向的滚动距离。现如今<em>Vue</em>,<em>React</em>大行其道的今天好多兼容性都没在考虑的范围，不过这里还是要提下。这两个属性在IE&lt;9的浏览器是不支持的。所以完整的兼容代码是：</p>
<pre><code>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let supportPageOffset = window.pageXOffset !== undefined</div><div class="line">let isCSS1Compat = ((document.compatMode || &quot;&quot;) === &quot;CSS1Compat&quot;)</div><div class="line"></div><div class="line">let x = supportPageOffset ? window.pageXOffset : isCSS1Compat ? document.documentElement.scrollLeft : document.body.scrollLeft;</div><div class="line">let y = supportPageOffset ? window.pageYOffset : isCSS1Compat ? document.documentElement.scrollTop : document.body.scrollTop;</div></pre></td></tr></table></figure>

然后在高版本的浏览器中可以用window.scrollX和window.scrollY来分别代替window.pageXOffset和window.pageYOffset。但是**IE浏览器不支持**。
</code></pre><p>  <code>document.compatMode</code>表示用户是否在怪异模式吧或者标准模式下。怪异模式下则显示<code>BackCompat</code>,非怪异模式则返回<code>CSS1Compat</code>。<br>  之前在IE的时候调试兼容性的时候面板里面就会有怪异模式,当用户没有设定那个<code>&lt;!DOCTYPE html&gt;</code>头的时候就会<br>  在怪异模式下,返回值是<code>BackCompat</code>。</p>
<p>  摘自<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/window/scrollY" target="_blank" rel="external">Mozilla中关于window.pageYOffset的表述</a></p>
<h2 id="clientWidth-clientHeight"><a href="#clientWidth-clientHeight" class="headerlink" title="clientWidth, clientHeight"></a>clientWidth, clientHeight</h2><p> <img src="/images/dimensions-client.png" alt=""><br> 获取元素的内宽度包括内边距(padding)离但不包括垂直滚动条,边框或者外边距(margin)。<strong>这里的元素必须是非内联的元素</strong>，除非设置内联元素默认显示属性即可设置其样式<code>display: inline-block</code>或者其它。<code>clientHeight</code>和<code>clientWidth</code>类似。</p>
<h2 id="window-innerWidth-window-innerHeight，window-outerWidth-window-outerHeight"><a href="#window-innerWidth-window-innerHeight，window-outerWidth-window-outerHeight" class="headerlink" title="window.innerWidth,window.innerHeight，window.outerWidth, window.outerHeight"></a>window.innerWidth,window.innerHeight，window.outerWidth, window.outerHeight</h2><p><img src="/images/innerheightvsouterheight.png" alt=""></p>
<p><code>window.innerWidth</code>指的是窗口视窗的宽度包括垂直滚动条的宽度。<code>window.innerHeight</code>窗口视窗的高度包括水平滚动条的高度。<code>window.outerHeight</code>指的是包括整个浏览器的容器的高度。<code>window.outerHeight</code>类似。</p>
<p><strong>以上这几个属性在IE9以下都不支持</strong>。</p>
<h2 id="offsetWidth-offsetHeight-offsetLeft-offsetTop-offsetParent"><a href="#offsetWidth-offsetHeight-offsetLeft-offsetTop-offsetParent" class="headerlink" title="offsetWidth, offsetHeight, offsetLeft, offsetTop, offsetParent"></a>offsetWidth, offsetHeight, offsetLeft, offsetTop, offsetParent</h2><p><img src="/images/dimensions-offset.png" alt=""></p>
<p><code>offsetWidth</code>元素的宽度包括元素的边框，元素水平内边距和垂直滚动条的宽度。<code>offsetHeight</code>与之类似，<br>这里获得的数值是四舍五入到整数，如果想要获取精益的数值可以用<code>element.getBoundingClientRect()</code>来获取。</p>
<p><code>offsetLeft</code>是获取元素相对于最近的定位的元素的左边距离,<code>offsetTop</code>类似。</p>
<iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/Wudiemperor/zpmb5c8b/1/embedded/js,html,css,result/light" frameborder="0" allowfullscreen></iframe>
<p>但是这里有个问题当是内联元素的时候这个显示会有些奇怪，因为那个内联元素是用的<code>Element.getClientRects</code>来获得宽度和高度从而导致这些内联元素不是个规则的有边框的盒模型。上面的示例就可以看到。</p>
<p><code>offsetParent</code>是获取元素最近定位的父元素。</p>
<p><strong>这里需要注意的是<code>getBoundingClientRect</code>获取top与<code>offsetTop</code>的区别</strong></p>
<p>看下示例就明白了:</p>
<iframe scrolling="no" width="100%" height="300" src="//jsfiddle.net/Wudiemperor/bzewb0za/embedded/js,html,css,result/light" frameborder="0" allowfullscreen></iframe>
<p>这里的<code>getBoundingClientRect</code>是以视图上的位置为基准的即相对于<strong>viewport</strong>的上，右，下，左的距离，而<code>offsetTop</code>是以最近的<strong>定位的元素</strong>，这里的定位元素,如果目标元素是<code>fixed</code>或者目标元素的最近的父元素是<code>static</code>定位的话的话两者是相等的,否则一般是不相等(排队了元素未在视图顶部的情况)。一个是相对于视图，一个是相对于最近的有定位的父元素。</p>
<h2 id="clientLeft-clientTop-window-screenX-window-screenY"><a href="#clientLeft-clientTop-window-screenX-window-screenY" class="headerlink" title="clientLeft, clientTop, window.screenX, window.screenY"></a>clientLeft, clientTop, window.screenX, window.screenY</h2><p><code>clientLeft</code>一个元素左边边框的宽度包含垂直滚动条的宽度但并不包含左外边距和左内边距。<code>clientTop</code>类似。</p>
<p><code>window.screenX</code> 用户的浏览器左边框和用户的屏幕左边之间的距离</p>
<p><code>window.screenY</code> 用户的浏览器上边框和用户的屏幕顶端之间的距离</p>
<h2 id="scrollTop-scrollLeft-scrollWidth-scrollHeight"><a href="#scrollTop-scrollLeft-scrollWidth-scrollHeight" class="headerlink" title="scrollTop, scrollLeft, scrollWidth, scrollHeight"></a>scrollTop, scrollLeft, scrollWidth, scrollHeight</h2><p><img src="/images/scrollTop.png" alt=""></p>
<p><code>scrollTop</code>获取或者设置一个元素垂直方向滚动的距离，表示的意思是元素方框的顶部和元素的最顶部的可见内容之间的距离。当一个元素内容没有产生垂直滚动条，那么这个值为0。</p>
<p>需要注意的有以下三点：</p>
<ul>
<li>当一个元素不可以滚动值为0</li>
<li>不接受负值相反会会设置回0</li>
<li>如果设置的最大滚动距离大于元素最大可滚动距离则只会应用元素最大可滚动距离</li>
</ul>
<p><code>scrollLeft</code>类似。</p>
<h2 id="event-clientX-event-clientY"><a href="#event-clientX-event-clientY" class="headerlink" title="event.clientX, event.clientY"></a>event.clientX, event.clientY</h2><p><code>event.clientX</code>触摸事件中的触摸点相对于视图的左位移不包括滚动的位移。<code>event.clientY</code>类似。<br>这两个可以应用在下拉刷新的插件(当是touch事件的时候), 拖拽的插件(当是鼠标事件的时候）。</p>
<p>大部分的属性都可以在<a href="https://www.quirksmode.org/mobile/tableViewport_desktop.html" target="_blank" rel="external">这里</a>找到。</p>
<p>接下来假设要写一个那种类似<a href="https://getbootstrap.com/docs/3.3/javascript/#scrollspy" target="_blank" rel="external">scrollspy</a>的插件需要用到的属性有：</p>
<p>那么这里需要应用到元素的一个属性<code>getBoundingClientRect</code>可以查看<a href="https://www.quirksmode.org/dom/w3c_cssom.html" target="_blank" rel="external">这里</a>的详细介绍,大意是这个是返回元素在视图，相对于视图左上角的位移。事实上不管滚动的容器是否是<code>body</code>最终都可以归纳到这个属性上面。<br>大概意思即：当前一个元素完全离开<code>viewport</code>视口的时候，会给激活下一个导航。滚动的距离要大于元素在当前滚动容器的位移。不知道有没有表述清楚呃!-.-。</p>
<p>这里有一个小snippet用来获取元素的滚动的距离</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">function getScrollDis () &#123;</div><div class="line">  let supportPageOffset = window.pageXOffset !== undefined</div><div class="line">  let isCSS1Compat = ((document.compatMode || &quot;&quot;) === &quot;CSS1Compat&quot;)</div><div class="line"></div><div class="line">  let x = supportPageOffset ? window.pageXOffset : isCSS1Compat ? document.documentElement.scrollLeft : document.body.scrollLeft;</div><div class="line">  let y = supportPageOffset ? window.pageYOffset : isCSS1Compat ? document.documentElement.scrollTop : document.body.scrollTop;</div><div class="line"></div><div class="line">  return &#123;</div><div class="line">    top: y,</div><div class="line">    left: x</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="当滚动的容器是body的时候"><a href="#当滚动的容器是body的时候" class="headerlink" title="当滚动的容器是body的时候"></a>当滚动的容器是<strong>body</strong>的时候</h3><p>当滚动的容器是<code>body</code>的时候直接获取滚动的距离，和元素本页面的位移和滚动的距离作对比。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let rect = elem.getBoundingClientRect()</div><div class="line">let scrollTop = getScrollDis().top</div><div class="line">let offset = &#123;&#125;</div><div class="line">offset.top = rect.top + win.pageYOffset - docElem.clientTop</div></pre></td></tr></table></figure>
<h3 id="当滚动的容器不是body的时候"><a href="#当滚动的容器不是body的时候" class="headerlink" title="当滚动的容器不是body的时候"></a>当滚动的容器<strong>不是body</strong>的时候</h3><p>与上面的是类似的只是这里需要计算的是元素相对的滚动容器不一样，可以参考下jQuery的<code>elem.postion()</code>来取得元素的位置。</p>
<h2 id="总结这里的进行判断有两种方法，可以实时进行计算滚动距离进行比较也可以采取和Bootstrap类似的方法初始化就位移区间的计算。只是这里在某些情况下你需要手动去重新计算一下位移区间。"><a href="#总结这里的进行判断有两种方法，可以实时进行计算滚动距离进行比较也可以采取和Bootstrap类似的方法初始化就位移区间的计算。只是这里在某些情况下你需要手动去重新计算一下位移区间。" class="headerlink" title="总结这里的进行判断有两种方法，可以实时进行计算滚动距离进行比较也可以采取和Bootstrap类似的方法初始化就位移区间的计算。只是这里在某些情况下你需要手动去重新计算一下位移区间。"></a>总结这里的进行判断有两种方法，可以实时进行计算滚动距离进行比较也可以采取和<strong>Bootstrap</strong>类似的方法初始化就位移区间的计算。只是这里在某些情况下你需要手动去重新计算一下位移区间。</h2><p><strong>以上的图片均来自于<a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/</a></strong></p>
<p>TodoList:</p>
<ul>
<li style="list-style: none"><input type="checkbox"> <code>getBoundingClientRect</code>与<code>getClientRects</code>的区别</li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2017/10/08/window-pageYOffset-window-pageXOffset-clientWidth-clientHeight-etc-一些JavaScript的基础属性/" data-id="cj9mag2up001fmmkl9w1kb2qy" class="article-share-link">分享到</a><div class="tags"><a href="/tags/scrollSpy/">scrollSpy</a><a href="/tags/pageYOffset/">pageYOffset</a></div><div class="post-nav"><a href="/2017/10/12/生活的意义/" class="pre">生活的意义</a><a href="/2017/10/02/去远方/" class="next">去远方</a></div><div id="uyan_frame"></div><script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2139658"></script></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/">Backend</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Essays/">Essays</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/FrontEnd/">FrontEnd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/">Tech</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/FrontEnd/">FrontEnd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tech/Source/">Source</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/backend/">backend</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/Essays/">Essays</a></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/FrontEnd/" style="font-size: 15px;">FrontEnd</a> <a href="/tags/affix/" style="font-size: 15px;">affix</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/jQuery/" style="font-size: 15px;">jQuery</a> <a href="/tags/scrollSpy/" style="font-size: 15px;">scrollSpy</a> <a href="/tags/offset/" style="font-size: 15px;">offset</a> <a href="/tags/position/" style="font-size: 15px;">position</a> <a href="/tags/Dom/" style="font-size: 15px;">Dom</a> <a href="/tags/CurrentTarget/" style="font-size: 15px;">CurrentTarget</a> <a href="/tags/automate/" style="font-size: 15px;">automate</a> <a href="/tags/Nodejs/" style="font-size: 15px;">Nodejs</a> <a href="/tags/ES6/" style="font-size: 15px;">ES6</a> <a href="/tags/express/" style="font-size: 15px;">express</a> <a href="/tags/Hoisting/" style="font-size: 15px;">Hoisting</a> <a href="/tags/Buffer/" style="font-size: 15px;">Buffer</a> <a href="/tags/token/" style="font-size: 15px;">token</a> <a href="/tags/jwt/" style="font-size: 15px;">jwt</a> <a href="/tags/jsonwebtoken/" style="font-size: 15px;">jsonwebtoken</a> <a href="/tags/pageYOffset/" style="font-size: 15px;">pageYOffset</a> <a href="/tags/Mobile/" style="font-size: 15px;">Mobile</a> <a href="/tags/css3/" style="font-size: 15px;">css3</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/人生感悟/" style="font-size: 15px;">人生感悟</a> <a href="/tags/1像素/" style="font-size: 15px;">1像素</a> <a href="/tags/愉快生活/" style="font-size: 15px;">愉快生活</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/28/DOM相关/">DOM相关</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/21/Nodejs-ES6/">Nodejs ES6</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/13/ES6碎碎念经/">ES6碎碎念经</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/12/生活的意义/">生活的意义</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/08/window-pageYOffset-window-pageXOffset-clientWidth-clientHeight-etc-一些JavaScript的基础属性/">window.pageYOffset, window.pageXOffset, clientWidth, clientHeight, etc,一些JavaScript的基础属性及实战应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/02/去远方/">去远方</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/13/Nodejs插件express-session详解/">Nodejs插件express-session详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/20/Bootstrap-affix-源码解读/">Bootstrap affix 源码解读</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/13/JavaScript-hoisting/">JavaScript-hoisting</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/10/NodeClub源码解析/">NodeClub源码解析</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.w.com/" title="医方" target="_blank">医方</a><ul></ul><a href="https://github.com/Troland" title="我的Github" target="_blank">我的Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Poeticlife.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>